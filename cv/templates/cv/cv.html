{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Hoja de Vida | {{ perfil.nombres }}</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        :root {
            --primary-color: #0d6efd;
            --bg-color: #f8fafc;
        }

        body {
            background-color: var(--bg-color);
            font-family: 'Inter', 'Segoe UI', sans-serif;
            scroll-behavior: smooth;
        }

        /* perfil centrado y moderno */
        .profile-card {
            background: #fff;
            border-radius: 24px;
            padding: 50px 35px;
            box-shadow: 0 15px 35px rgba(0,0,0,.05);
            border: none;
        }

        .profile-img {
            width: 180px;
            height: 180px;
            object-fit: cover;
            border-radius: 50%;
            border: 8px solid #eff6ff;
            box-shadow: 0 8px 20px rgba(13,110,253,.15);
        }

        /* tarjetas de secciones con diseño de borde lateral */
        .section-card {
            background: #fff;
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,.03);
            border-left: 5px solid var(--primary-color);
            transition: transform 0.3s ease;
        }

        .section-card:hover {
            transform: translateX(5px);
        }

        /* certificados y productos con efecto de elevación */
        .cert-card {
            border-left: none;
            transition: all .4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
        }

        .cert-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(13,110,253,.2);
        }

        .icon {
            color: var(--primary-color);
            font-size: 1.1rem;
        }

        .skill-badge {
            background-color: #eff6ff;
            color: var(--primary-color);
            padding: 10px 18px;
            border-radius: 12px;
            display: inline-block;
            margin: 6px;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .skill-badge:hover {
            background-color: var(--primary-color);
            color: white;
            transform: scale(1.05);
        }

        .ref-card {
            border-left: 5px solid #10b981; /* color verde para diferenciar referencias */
        }

        hr {
            opacity: 0.1;
        }

        @media print {
            nav, .btn, .modal, .navbar {
                display: none !important;
            }
            body { background: white; }
            .section-card { 
                box-shadow: none !important; 
                border: 1px solid #eee; 
                border-left: 5px solid var(--primary-color) !important;
                page-break-inside: avoid;
            }
        }
    </style>
</head>

<body>

<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
    <div class="container">
        <a class="navbar-brand fw-bold text-primary" href="/">
            <i class="bi bi-arrow-left-circle me-2"></i>Inicio
        </a>

        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto fw-medium">
                <li class="nav-item"><a class="nav-link" href="#perfil">Perfil</a></li>
                <li class="nav-item"><a class="nav-link" href="#educacion">Educación</a></li>
                <li class="nav-item"><a class="nav-link" href="#experiencia">Experiencia</a></li>
                <li class="nav-item"><a class="nav-link" href="#certificados">Certificados</a></li>
                <li class="nav-item"><a class="nav-link" href="#garage">Garage</a></li>
            </ul>
        </div>

       <button class="btn btn-primary shadow-sm ms-3" data-bs-toggle="modal" data-bs-target="#pdfOptionsModal">
            <i class="bi bi-printer me-1"></i> Imprimir / PDF
        </button>
    </div>
</nav>

<section id="perfil" class="container my-5">
    <div class="profile-card text-center">
        <div class="row justify-content-center">
            
            <div class="col-12 mb-4">
                {% if perfil.foto %}
                    <img src="{{ perfil.foto.url }}" class="profile-img">
                {% else %}
                    <img src="{% static 'img/user.png' %}" class="profile-img">
                {% endif %}
            </div>

            <div class="col-md-10">
                <h1 class="fw-bold mb-1" style="letter-spacing: -1px;">{{ perfil.nombres }} {{ perfil.apellidos }}</h1>
                <h4 class="text-primary mb-4 fw-medium">{{ perfil.profesion }}</h4>
                <p class="px-md-5 text-muted" style="font-size: 1.1rem; line-height: 1.8;">
                    {{ perfil.descripcion|linebreaksbr }}
                </p>

                <hr class="my-5">

                <div class="row text-start justify-content-center">
                    <div class="col-md-5">
                        <p><i class="bi bi-envelope-fill icon me-2"></i> {{ perfil.email }}</p>
                        <p><i class="bi bi-telephone-fill icon me-2"></i> {{ perfil.telefono }}</p>
                        <p><i class="bi bi-geo-alt-fill icon me-2"></i> {{ perfil.lugar_nacimiento }}</p>
                    </div>
                    <div class="col-md-5">
                        <p><i class="bi bi-person-fill icon me-2"></i> {{ perfil.sexo }}</p>
                        <p><i class="bi bi-flag-fill icon me-2"></i> {{ perfil.nacionalidad }}</p>
                        <p><i class="bi bi-credit-card-2-front-fill icon me-2"></i> Cédula: {{ perfil.cedula }}</p>
                    </div>
                </div>

                {% if perfil.sitio_web %}
                <div class="mt-4">
                    <a href="{{ perfil.sitio_web }}" target="_blank" class="btn btn-dark px-4 py-2">
                        <i class="bi bi-github me-2"></i>Ver Proyectos en GitHub
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<div class="container">
    <div class="row">
        <div class="col-lg-8">
            <section id="experiencia" class="mb-5">
                <h4 class="fw-bold mb-4"><i class="bi bi-briefcase me-2"></i> Experiencia Laboral</h4>
                {% for exp in experiencias %}
                <div class="section-card mb-3">
                    <h5 class="fw-bold mb-1">{{ exp.cargo }}</h5>
                    <span class="text-primary fw-medium">{{ exp.empresa }}</span><br>
                    <small class="text-muted">{{ exp.fecha_inicio }} — {{ exp.fecha_fin|default:"Actualidad" }}</small>
                    <p class="mt-3 text-muted">{{ exp.descripcion }}</p>
                </div>
                {% endfor %}
            </section>

            <section id="educacion" class="mb-5">
                <h4 class="fw-bold mb-4"><i class="bi bi-mortarboard me-2"></i> Educación</h4>
                {% for edu in educaciones %}
                <div class="section-card mb-3">
                    <h5 class="fw-bold mb-1">{{ edu.titulo }}</h5>
                    <span class="text-primary fw-medium">{{ edu.institucion }}</span><br>
                    <small class="text-muted">{{ edu.fecha_inicio }} — {{ edu.fecha_fin|default:"Actualidad" }}</small>
                </div>
                {% endfor %}
            </section>
        </div>

        <div class="col-lg-4">
            <section id="habilidades" class="mb-5">
                <h4 class="fw-bold mb-4"><i class="bi bi-cpu me-2"></i> Habilidades</h4>
                <div class="d-flex flex-wrap">
                    {% for hab in habilidades %}
                        <span class="skill-badge">{{ hab.nombre }}</span>
                    {% endfor %}
                </div>
            </section>

            <section id="referencias">
                <h4 class="fw-bold mb-4"><i class="bi bi-people me-2"></i> Referencias</h4>
                {% for ref in referencias %}
                <div class="section-card ref-card mb-3">
                    <strong class="text-dark">{{ ref.nombre }}</strong><br>
                    <small class="text-primary fw-medium">{{ ref.empresa }}</small><br>
                    <small class="text-muted"><i class="bi bi-telephone me-1"></i> {{ ref.telefono }}</small>
                </div>
                {% endfor %}
            </section>
        </div>
    </div>
</div>

<section id="certificados" class="container my-5">
    <h4 class="fw-bold mb-4"><i class="bi bi-patch-check me-2"></i> Certificados</h4>
    <div class="row">
        {% for cert in certificados %}
        <div class="col-md-4 mb-4">
            <div class="section-card cert-card text-center">
                {% if cert.imagen %}
                <a href="{{ cert.imagen.url }}" target="_blank">
                    <img src="{{ cert.imagen.url }}" class="img-fluid rounded-3 mb-3 shadow-sm">
                </a>
                {% endif %}
                <h6 class="fw-bold">{{ cert.titulo }}</h6>
                <small class="text-muted">{{ cert.institucion }}</small>
            </div>
        </div>
        {% endfor %}
    </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
function generatePDF() {
    const hiddenSections = [];
    document.querySelectorAll(".pdf-option").forEach(function(cb) {
        const section = document.querySelector(cb.value);
        if (section && !cb.checked) {
            section.style.display = "none";
            hiddenSections.push(section);
        }
    });
    const modalEl = document.getElementById("pdfOptionsModal");
    if (modalEl) {
        const modal = bootstrap.Modal.getInstance(modalEl);
        if (modal) modal.hide();
    }
    setTimeout(function () {
        window.print();
        hiddenSections.forEach(function(sec) { sec.style.display = ""; });
    }, 300);
}
</script>

<div class="modal fade" id="pdfOptionsModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 shadow">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title">Configurar Impresión</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <p class="text-muted small">Selecciona las secciones que aparecerán en el documento final:</p>
        <div class="row">
            <div class="col-6">
                <div class="form-check mb-2"><input class="form-check-input pdf-option" type="checkbox" value="#perfil" checked><label class="form-check-label">Perfil</label></div>
                <div class="form-check mb-2"><input class="form-check-input pdf-option" type="checkbox" value="#educacion" checked><label class="form-check-label">Educación</label></div>
                <div class="form-check mb-2"><input class="form-check-input pdf-option" type="checkbox" value="#experiencia" checked><label class="form-check-label">Experiencia</label></div>
            </div>
            <div class="col-6">
                <div class="form-check mb-2"><input class="form-check-input pdf-option" type="checkbox" value="#certificados" checked><label class="form-check-label">Certificados</label></div>
                <div class="form-check mb-2"><input class="form-check-input pdf-option" type="checkbox" value="#habilidades" checked><label class="form-check-label">Habilidades</label></div>
                <div class="form-check mb-2"><input class="form-check-input pdf-option" type="checkbox" value="#garage"><label class="form-check-label">Venta Garage</label></div>
            </div>
        </div>
      </div>
      <div class="modal-footer bg-light">
        <button class="btn btn-outline-secondary" data-bs-dismiss="modal">Cerrar</button>
        <button class="btn btn-primary px-4" onclick="generatePDF()">Generar PDF</button>
      </div>
    </div>
  </div>
</div>

</body>
</html>
